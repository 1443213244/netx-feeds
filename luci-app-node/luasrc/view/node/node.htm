<%
local uci = luci.model.uci.cursor()
local nods = uci:get("node","@node[0]", "nods")
local user = uci:get("node","@node[0]", "user")
local password = uci:get("node","@node[0]", "password")
-%>


<%+header%>
<script type="text/javascript">
	var stxhr = new XHR();
	function start_server(id) {
		//	document.location="/systeminfo.asp";
		// document.location = "<%=controller%>/admin/services/node/start";
		stxhr.post('<%=url('admin/services/node')%>/start', { token: '<%=token%>',id:+id },
				function(x)
				{
					if (x.responseText)
					{
						legend.style.display = 'none';
						output.innerHTML = String.format('<pre>%h</pre>', x.responseText);
					}
					else
					{
						legend.style.display = 'none';
						output.innerHTML = '<span class="error"><%:Bad address specified!%></span>';
					}
				}
			);

	}

	function stop_server() {
		//	document.location="/systeminfo.asp";
		document.location = "<%=controller%>/admin/services/node/stop";

	}

	function showbox() {
		var status = document.getElementById("statserver").style.display = 'block';
		console.log(status);

	}
</script>
<script type="text/javascript" src="/luci-static/resources/cbi.js"></script>
<h2 name="content"><%:Netx service%></h2>
<br />
<div class="alert-message notice" id="statserver" style="display:none;">
	<img src="/luci-static/resources/icons/loading.gif" alt="加载中" style="vertical-align:middle">
	<span>账号登陆中，请稍后…</span>
</div>
<form method="post" name="login" action="<%=REQUEST_URI%>" enctype="multipart/form-data">
	<fieldset class="cbi-section" id="cbi-user-login">
		<div class="cbi-section-login" style="float: left; width:60%">
			<div class="cbi-value" id="cbi-service-netx-user">
				<label class="cbi-value-title" for="user"><%:Username%></label>
				<div class="cbi-value-field">
					<input type="text" class="cbi-input-text" onchange="cbi_d_update(this.id)"
						name="user" id="user" value="<%=user%>" />
				</div>
			</div>

			<div class="cbi-value" id="cbi-service-netx-password"><label class="cbi-value-title"
					for="password"><%:Password%></label>
				<div class="cbi-value-field">

					<input type="password" class="cbi-input-password" onchange="" name="password"
						id="password" value="<%=password%>" />
				</div>
			</div>
		</div>


		<!-- <div class="cbi-section-info" style="float: right; width:40%">
			<div class="table">
				<div class="tr">
					<div class="td left">
						<%=html%>
					</div>
					<div class="td left">
						<%=level%>
					</div>
				</div>
				<div class="tr">
					<div class="td left">
						<%:Account status%>
					</div>
					<div class="td left">
						<%=status%>
					</div>
				</div>
				<div class="tr">
					<div class="td left">
						<%:End Date%>
					</div>
					<div class="td left">
						<%=enddata%>
					</div>
				</div>
			</div>
		</div> -->
		<div style="margin-top: 100px; margin-left: 22%;">
			<input type="submit" class="cbi-button cbi-button-reload" style="width:200px" onClick="showbox()" title="登录获取节点" value="登录">
		</div>
		
	</fieldset>


	<fieldset class="cbi-section" id="cbi-system-system">

			<div class="cbi-value" id="cbi-jiasu-line">
				<legend><%:node list%></legend>
				<div class="cbi-value">
					<table class="cbi-section-table" style="margin:10px; empty-cells:hide">
						<tbody><tr class="cbi-section-table-titles">
							<th class="cbi-section-table-cell">网络</th>
							<th class="cbi-section-table-cell" style="text-align:left">状态</th>
							<th class="cbi-section-table-cell">动作</th>
						</tr>
							
							<tr class="cbi-section-table-row cbi-rowstyle-2">
								
								<td class="cbi-value-field" style="vertical-align:middle; text-align:left; padding:3px" id="lan-ifc-description">
									<strong>远程IP:</strong> 23.234.213.158<br>
									<strong>场景:</strong> 直播/普通代理<br>
									<strong>本地IP</strong>:  192.168.3.49<br>
									<strong>relay协议端口</strong>: 50001    （手机直播推荐）<br>
									<strong>socks5 /http协议端口</strong> 50000 （常规场景）<br>
								</td>
								<td>
									运行中
								</td>
								<td style="width:420px">
									<input type="button" class="cbi-button cbi-button-reload" style="width:100px" onclick="start_server(1)" title="重连此接口" value="开启">
									<input type="button" class="cbi-button cbi-button-reset" style="width:100px" onclick="stop_server(2)" title="关闭此接口" value="停止">
								</td>
							</tr>
					</tbody>
				</table>
				</div>
			</div>

	</fieldset>
	
	<script type="text/javascript">cbi_d_update();</script>
	</from>
	<%+footer%>